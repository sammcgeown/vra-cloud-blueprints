name: MEW Demo
version: 1
formatVersion: 1
inputs:
  Cluster Size:
    type: number
    default: '1'
    minimum: 1
    maximum: 3
resources:
  Cloud_LoadBalancer_1:
    type: Cloud.LoadBalancer
    properties:
      routes:
        - protocol: HTTP
          port: 80
          instanceProtocol: HTTP
          instancePort: 80
      network: '${resource.Cloud_Network_1.id}'
      instances: '${resource.WebServer[*].id}'
      internetFacing: false
  WebServer:
    type: Cloud.Machine
    properties:
      count: '${input.Cluster Size}'
      image: ubuntu-xenial
      flavor: small
      networks:
        - network: '${resource.Cloud_Network_1.id}'
  Cloud_Network_1:
    type: Cloud.Network
    properties:
      networkType: existing
